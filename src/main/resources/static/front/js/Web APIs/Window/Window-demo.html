<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge,chrome=1" />
    <title>Window-demo</title>
    <link rel="stylesheet" href="../../../../public/css/demo.css" />
  </head>
  <body>
    <section class="code-wrap h600">
      <div class="css-live-wrap w100p">
        <div class="caption">
          <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window#%E5%AE%9E%E4%BE%8B%E5%B1%9E%E6%80%A7" target="_blank">属性</a>
        </div>
        <div class="centered">
          <table class="w1024">
            <tr>
              <th>属性</th>
              <th>概述</th>
              <th>示例</th>
            </tr>
            <tr>
              <td>closed</td>
              <td>表示当前窗口是否关闭，返回 true 或 false</td>
              <td></td>
            </tr>
            <tr>
              <td>frames</td>
              <td>返回当前窗口，一个类数组对象，列出了当前窗口的所有直接子窗口</td>
              <td></td>
            </tr>
            <tr>
              <td>length</td>
              <td>设置或返回当前窗口中的框架数量(frame 和 iframe)</td>
              <td></td>
            </tr>
            <tr>
              <td>innerHeight</td>
              <td>浏览器的视口（viewport）高度，包括水平滚动条</td>
              <td rowspan="2">
                <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/innerHeight/firefoxinnervsouterheight2.png" target="_blank">图像示例</a>
              </td>
            </tr>
            <tr>
              <td>outerheight</td>
              <td>浏览器的高度，包括侧边栏、窗口镶边（window chrome）， <br />和窗口调正边框（window resizing borders/handles）</td>
            </tr>
            <tr>
              <td>innerWidth</td>
              <td>浏览器的视口（viewport）宽度，包括垂直滚动条</td>
              <td>
                <a href="javascript: alert(innerWidth);">innerWidth</a>
              </td>
            </tr>
            <tr>
              <td>outerWidth</td>
              <td>浏览器的宽度，包括侧边栏、窗口镶边（window chrome）， <br />和窗口调正边框（window resizing borders/handles）</td>
              <td>
                <a href="javascript: alert(outerWidth);">outerWidth</a>
              </td>
            </tr>
            <tr>
              <td>name</td>
              <td>设置或返回窗口的名称</td>
              <td>
                <a href="./Window-name-demo.html" target="_blank">解决跨域问题</a>
              </td>
            </tr>
            <tr>
              <td>opener</td>
              <td>返回打开当前窗口的那个窗口的引用</td>
              <td></td>
            </tr>
            <tr>
              <td>top</td>
              <td>返回当前窗口的顶层窗口的引用</td>
              <td></td>
            </tr>
            <tr>
              <td>parent</td>
              <td>返回当前窗口的父窗口的引用</td>
              <td></td>
            </tr>
            <tr>
              <td>self</td>
              <td>返回当前窗口的引用，即 window</td>
              <td></td>
            </tr>
            <tr>
              <td>screenX</td>
              <td>返回浏览器左边界到系统桌面左边界的水平距离</td>
              <td>
                <a href="javascript: alert(screenX);">screenX</a>
              </td>
            </tr>
            <tr>
              <td>screenY</td>
              <td>返回浏览器顶部到系统桌面顶部的垂直距离</td>
              <td>
                <a href="javascript: alert(screenY);">screenY</a>
              </td>
            </tr>
          </table>
        </div>
      </div>
    </section>

    <section class="code-wrap h550">
      <div class="css-live-wrap w100p">
        <div class="caption">
          <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window#%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95" target="_blank">方法</a>
        </div>
        <div class="centered">
          <table class="w1024">
            <tr>
              <th>方法</th>
              <th>概述</th>
              <th>示例</th>
            </tr>
            <tr>
              <td>alert()</td>
              <td>显示带有一段消息和一个确认按钮的警告框</td>
              <td>
                <a href="javascript: alert('警告');">alert('警告')</a>
              </td>
            </tr>
            <tr>
              <td>confirm()</td>
              <td>显示带有一段消息以及确认按钮和取消按钮的对话框</td>
              <td>
                <a href="javascript: if (confirm('确定?')) { alert('yes') } else { alert('no') }">confirm('确定?')</a>
              </td>
            </tr>
            <tr>
              <td>prompt()</td>
              <td>显示可提示用户输入的对话框</td>
              <td>
                <a href="javascript: const result = prompt('请输入您的名字', ''); alert(result);"> prompt('请输入您的名字', '') </a>
              </td>
            </tr>
            <tr>
              <td><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/open">open()</a></td>
              <td>打开一个新的浏览器窗口或查找一个已命名的窗口</td>
              <td>
                <a href="javascript: open('https://baidu.com', '', 'popup')">open('https://baidu.com', '', 'popup')</a>
              </td>
            </tr>
            <tr>
              <td>close()</td>
              <td>关闭由 window.open 打开的窗口或某个指定的窗口</td>
              <td></td>
            </tr>
            <tr>
              <td>moveTo()</td>
              <td>将当前窗口移动到指定的坐标位置</td>
              <td>
                <a href="javascript: moveTo(10, 10);">moveTo(10, 10)</a>
              </td>
            </tr>
            <tr>
              <td>moveBy()</td>
              <td>相对窗口当前坐标来移动窗口</td>
              <td>
                <a href="javascript: moveBy(10, 10);">moveBy(10, 10)</a>
              </td>
            </tr>
            <tr>
              <td>print()</td>
              <td>打开打印对话框，以打印当前文档</td>
              <td></td>
            </tr>
            <tr>
              <td>resizeTo()</td>
              <td>将窗口的大小调整到指定的宽度和高度</td>
              <td>
                <a href="javascript: resizeTo(600, 400);">resizeTo(600, 400)</a>
              </td>
            </tr>
            <tr>
              <td>resizeBy()</td>
              <td>相对窗口当前大小来调整窗口大小</td>
              <td>
                <a href="javascript: resizeTo(-50, -50);">resizeTo(-50, -50)</a>
              </td>
            </tr>
            <tr>
              <td>scrollTo()</td>
              <td>将文档滚动到指定的坐标</td>
              <td>
                <a href="javascript: scrollTo(0, 500);">scrollTo(0, 500)</a>
              </td>
            </tr>
            <tr>
              <td>scrollBy()</td>
              <td>按指定的像素值来滚动文档</td>
              <td>
                <a href="javascript: scrollBy(0, -200);">scrollBy(0, -50)</a>
              </td>
            </tr>
            <tr>
              <td>
                <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/getComputedStyle" target="_blank">getComputedStyle()</a>
              </td>
              <td>获取指定元素的 CSS 样式</td>
              <td>getComputedStyle(ele, null).getPropertyValue('color')</td>
            </tr>
            <tr>
              <td colspan="3">
                moveXX, resizeXX 在以下情况无效 <br />1.当前窗口或标签页不是由 window.open 方法创建的 <br />2.当前标签页所在的窗口包含有多个标签页
              </td>
            </tr>
          </table>
        </div>
      </div>
    </section>

    <section class="code-wrap h650">
      <div class="css-live-wrap w33p">
        <div class="caption">打印多张图片</div>
        <div class="caption">window.print()</div>
        <div class="confirm centered">
          <div class="demo-button" onclick="printImagesSeparately()">print</div>
        </div>
      </div>
      <script class="code w67p" contenteditable="true">
        async function printImagesSeparately () {
          const imgUrls = ['關羽', '張飛', '趙雲'].map((name) => `../../../../../static/public/img/people/${name}.png`)

          // 1. 预加载所有图片（可选）
          await Promise.all(imgUrls.map((url) => (new Promise((resolve) => (new Image().onload = resolve)).src = url)))

          // 2. 创建隔离打印环境
          const iframe = document.createElement('iframe')
          iframe.style.cssText = 'position:fixed;width:0;height:0;border:0'
          document.body.appendChild(iframe)

          // 3. 构建受控打印内容
          const html = `<html><style>
                          @page { margin: 5mm; } /* 安全边距 */
                          .page {
                            page-break-after: always; /* 兼容旧浏览器 */
                            height: calc(100vh - 10mm); /* 预留边距 */
                            display: grid;
                            place-items: center;
                          }
                          img {
                            max-width: 95%;
                            max-height: 95%;
                            object-fit: contain;
                           }
                        </style><body>
                          ${imgUrls.map(url => `<div class="page"><img src="${url}"></div>`).join('')}
                        </body></html>`

          // 4. 加载并触发打印
          iframe.contentDocument.write(html)
          iframe.contentDocument.close()
          iframe.onload = () => {
            iframe.contentWindow.print()
            setTimeout(() => iframe.remove(), 3000)
          }
        }
      </script>
    </section>
  </body>
</html>
