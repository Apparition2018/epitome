<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>实例方法</title>
    <link rel="icon" href="../../../static/img/ico/NoharaSinnosuke.ico">
    <link rel="stylesheet" href="../../../static/css/demo.css">
    <link href="https://cdn.bootcdn.net/ajax/libs/element-ui/2.15.1/theme-chalk/index.min.css" rel="stylesheet">
    <script src="https://cdn.bootcdn.net/ajax/libs/vue/2.6.12/vue.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/element-ui/2.15.1/index.min.js"></script>
</head>
<body>
<section class="code-wrap h350">
    <div class="css-live-wrap">
        <div class="caption">使用 $set() 更新视图</div>
        <div class="caption">
            <a href="https://segmentfault.com/a/1190000014826146">Vue 不能检测数组和对象的变化</a>
        </div>
        <div class="centered" id="app" style="text-align:center;">
            <div class="circles">
                <div v-for="(item, index) in items" :key="index" class="circle" @click="plus(index)">{{ item }}</div>
            </div>
        </div>
    </div>
    <script class="code" contenteditable="true">
        new Vue({
            el: '#app',
            data() {
                return {
                    isClick: true,
                    items: [1, 2, 3]
                }
            },
            methods: {
                plus(i) {
                    if (this.isClick) {
                        this.isClick = false;
                        setTimeout(() => {this.isClick = true}, 1000);
                        // this.items[i] = this.items[i] + 1;
                        this.$set(this.items, i, ++this.items[i])
                        console.log(this.items)
                    }
                }
            }
        })
    </script>
    <style>
        .circle {
            display: inline-block;
            width: 50px;
            line-height: 50px;
            margin: 5px;
            background-image: linear-gradient(300deg, #dfe9f3 0%, #ffffff 100%);
            border-radius: 50%;
            cursor: pointer;
        }
    </style>
</section>

<section class="code-wrap h350">
    <div class="css-live-wrap">
        <div class="caption">$nextTick</div>
        <div class="centered" id="app2">
            <div class="demo-button" @click="updateMessage($event)">
                {{ message }}
            </div>
        </div>
    </div>
    <script class="code" contenteditable="true">
        new Vue({
            el: '#app2',
            data() {
                return {
                    message: 'Click Me',
                }
            },
            methods: {
                updateMessage(e) {
                    this.message = 'Clicked'
                    this.$message.info(e.currentTarget.textContent)
                    this.$nextTick(() => {
                        this.$message.info(e.currentTarget.textContent)
                    })
                }
            }
        })
    </script>
</section>
</body>
</html>